"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(t,e){var a=[],r=!0,i=!1,n=void 0;try{for(var s,o=t[Symbol.iterator]();!(r=(s=o.next()).done)&&(a.push(s.value),!e||a.length!==e);r=!0);}catch(t){i=!0,n=t}finally{try{r||null==o.return||o.return()}finally{if(i)throw n}}return a}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,a){return e&&_defineProperties(t.prototype,e),a&&_defineProperties(t,a),t}var AnimatedSVGDial=function(){function r(t,e){if(_classCallCheck(this,r),void 0!==t){if(this.parentElement={},"string"==typeof t)this.parentElement=document.querySelector(t);else if(t instanceof jQuery){var a=_slicedToArray(t,1);this.parentElement=a[0]}else this.isObject(t)&&(this.parentElement=t);this.params=this.extendParams(e),this.hideText=1<this.params.length,this.svgElement=this.createSvgElement(),this.styleElement=this.createElement("defs",new Map),this.initHtml(),this.parentElement.appendChild(this.svgElement),this.initAnimationParams()}}return _createClass(r,[{key:"animate",value:function(){for(var t=0;t<this.params.length;t++){var e=this.params[t];this.animateSvgRadialProgressBar(t,e)}}},{key:"reset",value:function(){for(var t=0;t<this.params.length;t++)this.resetDialParams(t)}},{key:"initAnimationParams",value:function(){for(var t=0;t<this.params.length;t++){var e=this.params[t];this.setDialParams(t,e)}}},{key:"animateSvgRadialProgressBar",value:function(t,e){var a=this;if(void 0!==e.value&&!Number.isNaN(e.value)&&!(void 0!==e.maxValue&&Number.isNaN(e.maxValue)||void 0!==e.animationDuration&&Number.isNaN(e.animationDuration)||void 0!==e.animationOffset&&Number.isNaN(e.animationOffset))){var r=this.svgElement.querySelectorAll(".circle")[t],i=2*r.getAttribute("r")*Math.PI,n=e.maxValue,s=this.svgElement.querySelector("text"),o=i/n*(n-e.value);setTimeout(function(){r.setAttribute("stroke-dashoffset",o),a.hideText||null==s||(s.textContent=e.text)},e.animationOffset)}}},{key:"setDialParams",value:function(t,e){if(void 0===e.animationDuration||!Number.isNaN(e.animationDuration)){var a=this.svgElement.querySelectorAll(".circle")[t],r=2*a.getAttribute("r")*Math.PI,i=e.animationDuration/1e3,n="".concat(i,"s ").concat(e.animationEasing);a.setAttribute("stroke-dasharray",r),a.setAttribute("stroke-dashoffset",r),a.setAttribute("style","transition: stroke-dashoffset ".concat(n,";"))}}},{key:"resetDialParams",value:function(t){var e=this.svgElement.querySelectorAll(".circle")[t];if(null!=e&&e.setAttribute("stroke-dashoffset",e.getAttribute("stroke-dasharray")),!this.hideText){var a=this.svgElement.querySelector("text");null!=a&&(a.textContent="")}}},{key:"initHtml",value:function(){this.setSVGDefs(this.params),this.setGraphicElements(this.params)}},{key:"setGraphicElements",value:function(t){for(var e=0;e<t.length;e++){var a=t[e];if(this.svgElement.appendChild(this.createElement("circle",a.backgroundCircleParams)),this.svgElement.appendChild(this.createElement("circle",a.foregroundCircleParams)),1===t.length){var r=this.createElement("text",a.textParams);this.svgElement.appendChild(r)}}}},{key:"setSVGDefs",value:function(t){for(var e=0;e<t.length;e++){var a=t[e];if(a.gradient){var r=void 0;r="linear"===a.gradient.type?this.createElement("linearGradient",a.gradient.params):this.createElement("radialGradient",a.gradient.params);for(var i=0;i<a.gradient.stops.length;i++){var n=a.gradient.stops[i];r.appendChild(this.createElement("stop",n))}this.styleElement.appendChild(r)}}this.svgElement.appendChild(this.styleElement)}},{key:"extendParams",value:function(t){var e=[];if(this.isObject(t))e.push(t);else if(!Array.isArray(t))return[];for(var a=[],r=0;r<e.length;r++){var i=e[r],n={};a.push(n),n.gradient=this.getGradientParams(i),n.backgroundCircleParams=this.getBackgroundDialParams(i),n.foregroundCircleParams=this.getForegroundDialParams(i),n.textParams=this.getTextParams(i),n.animationDuration=i.animationDuration||350,n.animationOffset=i.animationOffset||0,n.animationEasing=i.animationEasing||"ease-out",n.text=i.text||"",n.value=i.value||50,n.maxValue=i.maxValue||100}return a}},{key:"getBackgroundDialParams",value:function(t){if(void 0===t)return new Map;var e=new Map;return e.set("cx","50"),e.set("cy","50"),e.set("r",t.r||40),e.set("fill",t.bkgFill||"none"),e.set("stroke",t.bkgStrokeColor||"black"),e.set("stroke-width",t.bkgStrokeWidth||"10"),e.set("stroke-opacity",t.bkgStrokeOpacity||"0.4"),e}},{key:"getForegroundDialParams",value:function(t){if(void 0===t)return new Map;var e=new Map;return e.set("class","circle"),e.set("cx","50"),e.set("cy","50"),e.set("r",t.r||40),e.set("fill",t.fill||"none"),e.set("stroke",t.strokeColor||"black"),e.set("stroke-width",t.strokeWidth||"10"),e.set("stroke-opacity",t.strokeOpacity||"1"),e.set("stroke-linecap",t.strokeLineCap||"round"),e}},{key:"getTextParams",value:function(t){if(void 0===t)return new Map;var e=new Map;return e.set("x",t.textX||"50%"),e.set("y",t.textY||"-45"),e.set("style",t.textStyle||"transform: rotate(90deg);"),e.set("fill",t.textFill||"black"),e.set("stroke",t.textStrokeColor||"none"),e.set("stroke-width",t.textStrokeWidth||"0"),e.set("font-size",t.textSize||"18"),e.set("font-weight",t.textWeight||"normal"),e.set("font-family",t.textFont||"Verdana"),e.set("text-anchor",t.textAnchor||"middle"),e}},{key:"getGradientParams",value:function(t){if(void 0!==t.gradient){var a={type:t.gradient.type,params:new Map,stops:[]};return a.params.set("id",t.gradient.id),"linear"===t.gradient.type?(a.params.set("x1",t.gradient.x1||"0%"),a.params.set("y1",t.gradient.y1||"0%"),a.params.set("x2",t.gradient.x2||"100%"),a.params.set("y2",t.gradient.y2||"0%")):(a.params.set("cx",t.gradient.cx||"0%"),a.params.set("cy",t.gradient.cy||"0%"),a.params.set("r",t.gradient.r||"5"),a.params.set("fx",t.gradient.fx||"45%"),a.params.set("fy",t.gradient.fy||"45%")),t.gradient.stops.forEach(function(t){var e=new Map;e.set("offset",t.offset||"0%"),e.set("stop-color",t.stopColor||"#FFFFFF"),e.set("stop-opacity",t.stopOpacity||"1"),a.stops.push(e)}),a}}},{key:"createSvgElement",value:function(){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");return t.setAttribute("viewBox","0 0 100 100"),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("style","transform: rotate(-90deg);"),t}},{key:"createElement",value:function(t,e){var a=document.createElementNS("http://www.w3.org/2000/svg",t);return 0<e.size&&e.forEach(function(t,e){return a.setAttribute(e,t)}),a}},{key:"isObject",value:function(t){return t&&"object"===_typeof(t)&&t.constructor===Object}}]),r}();